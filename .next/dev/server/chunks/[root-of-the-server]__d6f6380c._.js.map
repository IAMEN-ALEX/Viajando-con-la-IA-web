{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Asus/OneDrive/Desktop/viajando-con-ia-web/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient()\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Asus/OneDrive/Desktop/viajando-con-ia-web/src/app/api/auth/forgot-password/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport crypto from 'crypto';\r\nimport { Resend } from 'resend';\r\n\r\nconst resend = new Resend(process.env.RESEND_API_KEY);\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { email } = await req.json();\r\n\r\n        if (!email) {\r\n            return NextResponse.json(\r\n                { message: 'El correo es requerido' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Find user by email\r\n        const user = await prisma.user.findUnique({\r\n            where: { email }\r\n        });\r\n\r\n        // Always return success to prevent email enumeration attacks\r\n        // But only send email if user exists\r\n        if (user) {\r\n            // Generate secure random token\r\n            const resetToken = crypto.randomBytes(32).toString('hex');\r\n            const resetTokenExpiry = new Date(Date.now() + 3600000); // 1 hour from now\r\n\r\n            // Save token to database\r\n            await prisma.user.update({\r\n                where: { email },\r\n                data: {\r\n                    resetToken,\r\n                    resetTokenExpiry\r\n                }\r\n            });\r\n\r\n            const resetUrl = `${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/reset-password?token=${resetToken}`;\r\n\r\n            // Log for development\r\n            console.log('='.repeat(80));\r\n            console.log('PASSWORD RESET REQUEST');\r\n            console.log('='.repeat(80));\r\n            console.log(`Email: ${email}`);\r\n            console.log(`Reset URL: ${resetUrl}`);\r\n            console.log(`Token expires: ${resetTokenExpiry.toISOString()}`);\r\n            console.log('='.repeat(80));\r\n\r\n            // Send email with Resend\r\n            try {\r\n                await resend.emails.send({\r\n                    from: 'Viajando con la IA <onboarding@resend.dev>', // Use your verified domain in production\r\n                    to: email,\r\n                    subject: 'Recuperaci√≥n de Contrase√±a - Viajando con la IA',\r\n                    html: `\r\n                        <!DOCTYPE html>\r\n                        <html>\r\n                        <head>\r\n                            <meta charset=\"utf-8\">\r\n                            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n                            <title>Recuperaci√≥n de Contrase√±a</title>\r\n                        </head>\r\n                        <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #000000;\">\r\n                            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\r\n                                <tr>\r\n                                    <td align=\"center\" style=\"padding: 40px 0;\">\r\n                                        <table role=\"presentation\" style=\"width: 600px; border-collapse: collapse; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 16px; overflow: hidden; box-shadow: 0 20px 60px rgba(99, 102, 241, 0.3);\">\r\n                                            <!-- Header -->\r\n                                            <tr>\r\n                                                <td style=\"padding: 40px 40px 20px 40px; text-align: center; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);\">\r\n                                                    <h1 style=\"margin: 0; font-size: 32px; font-weight: 800; background: linear-gradient(135deg, #6366f1, #8b5cf6, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;\">\r\n                                                        Viajando con la IA\r\n                                                    </h1>\r\n                                                </td>\r\n                                            </tr>\r\n                                            \r\n                                            <!-- Content -->\r\n                                            <tr>\r\n                                                <td style=\"padding: 40px; color: #e2e8f0;\">\r\n                                                    <h2 style=\"margin: 0 0 20px 0; font-size: 24px; font-weight: 700; color: #f1f5f9;\">\r\n                                                        üîê Recuperaci√≥n de Contrase√±a\r\n                                                    </h2>\r\n                                                    \r\n                                                    <p style=\"margin: 0 0 20px 0; font-size: 16px; line-height: 1.6; color: #cbd5e1;\">\r\n                                                        Hola <strong style=\"color: #818cf8;\">${user.name}</strong>,\r\n                                                    </p>\r\n                                                    \r\n                                                    <p style=\"margin: 0 0 20px 0; font-size: 16px; line-height: 1.6; color: #cbd5e1;\">\r\n                                                        Recibimos una solicitud para restablecer la contrase√±a de tu cuenta. Si no fuiste t√∫, puedes ignorar este correo de forma segura.\r\n                                                    </p>\r\n                                                    \r\n                                                    <p style=\"margin: 0 0 30px 0; font-size: 16px; line-height: 1.6; color: #cbd5e1;\">\r\n                                                        Para crear una nueva contrase√±a, haz clic en el siguiente bot√≥n:\r\n                                                    </p>\r\n                                                    \r\n                                                    <!-- Button -->\r\n                                                    <table role=\"presentation\" style=\"margin: 0 auto 30px auto;\">\r\n                                                        <tr>\r\n                                                            <td style=\"border-radius: 12px; background: linear-gradient(135deg, #6366f1, #8b5cf6); box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);\">\r\n                                                                <a href=\"${resetUrl}\" style=\"display: inline-block; padding: 16px 40px; font-size: 16px; font-weight: 600; color: #ffffff; text-decoration: none; border-radius: 12px;\">\r\n                                                                    Restablecer Contrase√±a\r\n                                                                </a>\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    </table>\r\n                                                    \r\n                                                    <p style=\"margin: 0 0 10px 0; font-size: 14px; line-height: 1.6; color: #94a3b8;\">\r\n                                                        O copia y pega este enlace en tu navegador:\r\n                                                    </p>\r\n                                                    \r\n                                                    <p style=\"margin: 0 0 30px 0; padding: 12px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; font-size: 13px; color: #818cf8; word-break: break-all; border: 1px solid rgba(129, 140, 248, 0.2);\">\r\n                                                        ${resetUrl}\r\n                                                    </p>\r\n                                                    \r\n                                                    <div style=\"padding: 16px; background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; border-radius: 8px; margin-bottom: 20px;\">\r\n                                                        <p style=\"margin: 0; font-size: 14px; color: #fca5a5; line-height: 1.5;\">\r\n                                                            ‚ö†Ô∏è <strong>Importante:</strong> Este enlace expirar√° en <strong>1 hora</strong> por razones de seguridad.\r\n                                                        </p>\r\n                                                    </div>\r\n                                                    \r\n                                                    <p style=\"margin: 0; font-size: 14px; line-height: 1.6; color: #94a3b8;\">\r\n                                                        Si no solicitaste este cambio, tu cuenta permanece segura y puedes ignorar este mensaje.\r\n                                                    </p>\r\n                                                </td>\r\n                                            </tr>\r\n                                            \r\n                                            <!-- Footer -->\r\n                                            <tr>\r\n                                                <td style=\"padding: 30px 40px; background: rgba(0, 0, 0, 0.3); border-top: 1px solid rgba(255, 255, 255, 0.1);\">\r\n                                                    <p style=\"margin: 0 0 10px 0; font-size: 13px; color: #64748b; text-align: center;\">\r\n                                                        Este es un correo autom√°tico, por favor no respondas a este mensaje.\r\n                                                    </p>\r\n                                                    <p style=\"margin: 0; font-size: 13px; color: #475569; text-align: center;\">\r\n                                                        ¬© ${new Date().getFullYear()} Viajando con la IA. Todos los derechos reservados.\r\n                                                    </p>\r\n                                                </td>\r\n                                            </tr>\r\n                                        </table>\r\n                                    </td>\r\n                                </tr>\r\n                            </table>\r\n                        </body>\r\n                        </html>\r\n                    `\r\n                });\r\n\r\n                console.log(`‚úÖ Email sent successfully to ${email}`);\r\n            } catch (emailError) {\r\n                console.error('‚ùå Error sending email:', emailError);\r\n                // Don't fail the request if email fails, just log it\r\n                // In production, you might want to queue this for retry\r\n            }\r\n        }\r\n\r\n        // Always return success message\r\n        return NextResponse.json({\r\n            message: 'Si el correo existe, recibir√°s un enlace de recuperaci√≥n'\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Error in forgot-password:', error);\r\n        return NextResponse.json(\r\n            { message: 'Error al procesar la solicitud' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,oJAAM,CAAC,QAAQ,GAAG,CAAC,cAAc;AAE7C,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,IAAI;QAEhC,IAAI,CAAC,OAAO;YACR,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;YAAyB,GACpC;gBAAE,QAAQ;YAAI;QAEtB;QAEA,qBAAqB;QACrB,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACtC,OAAO;gBAAE;YAAM;QACnB;QAEA,6DAA6D;QAC7D,qCAAqC;QACrC,IAAI,MAAM;YACN,+BAA+B;YAC/B,MAAM,aAAa,gHAAM,CAAC,WAAW,CAAC,IAAI,QAAQ,CAAC;YACnD,MAAM,mBAAmB,IAAI,KAAK,KAAK,GAAG,KAAK,UAAU,kBAAkB;YAE3E,yBAAyB;YACzB,MAAM,gIAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACrB,OAAO;oBAAE;gBAAM;gBACf,MAAM;oBACF;oBACA;gBACJ;YACJ;YAEA,MAAM,WAAW,GAAG,6DAAmC,wBAAwB,sBAAsB,EAAE,YAAY;YAEnH,sBAAsB;YACtB,QAAQ,GAAG,CAAC,IAAI,MAAM,CAAC;YACvB,QAAQ,GAAG,CAAC;YACZ,QAAQ,GAAG,CAAC,IAAI,MAAM,CAAC;YACvB,QAAQ,GAAG,CAAC,CAAC,OAAO,EAAE,OAAO;YAC7B,QAAQ,GAAG,CAAC,CAAC,WAAW,EAAE,UAAU;YACpC,QAAQ,GAAG,CAAC,CAAC,eAAe,EAAE,iBAAiB,WAAW,IAAI;YAC9D,QAAQ,GAAG,CAAC,IAAI,MAAM,CAAC;YAEvB,yBAAyB;YACzB,IAAI;gBACA,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;oBACrB,MAAM;oBACN,IAAI;oBACJ,SAAS;oBACT,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6FA8BkE,EAAE,KAAK,IAAI,CAAC;;;;;;;;;;;;;;;yEAehC,EAAE,SAAS;;;;;;;;;;;;wDAY5B,EAAE,SAAS;;;;;;;;;;;;;;;;;;;;;;0DAsBT,EAAE,IAAI,OAAO,WAAW,GAAG;;;;;;;;;;oBAUjE,CAAC;gBACL;gBAEA,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,OAAO;YACvD,EAAE,OAAO,YAAY;gBACjB,QAAQ,KAAK,CAAC,0BAA0B;YACxC,qDAAqD;YACrD,wDAAwD;YAC5D;QACJ;QAEA,gCAAgC;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;QACb;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;QAAiC,GAC5C;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Asus/OneDrive/Desktop/viajando-con-ia-web/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient()\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Asus/OneDrive/Desktop/viajando-con-ia-web/src/app/api/trips/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET(req: Request) {\r\n    try {\r\n        const { searchParams } = new URL(req.url);\r\n        const userId = searchParams.get('userId');\r\n\r\n        console.log('[API_DEBUG] GET /api/trips Request:', { userId });\r\n\r\n        if (!userId) {\r\n            console.error('[API_DEBUG] Missing userId');\r\n            return NextResponse.json(\r\n                { message: 'Usuario no identificado' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const trips = await prisma.trip.findMany({\r\n            where: { userId },\r\n            include: {\r\n                notes: {\r\n                    orderBy: { createdAt: 'desc' }\r\n                }\r\n            },\r\n            orderBy: { createdAt: 'desc' },\r\n        });\r\n\r\n        // Format for frontend\r\n        const formattedTrips = trips.map((trip: any) => ({\r\n            id: trip.id,\r\n            destination: trip.destination,\r\n            startDate: trip.startDate, // Assuming stored as string per schema/frontend\r\n            endDate: trip.endDate,\r\n            notes: trip.notes.map((n: any) => ({ id: n.id, content: n.content })), // Send objects or strings? Frontend expects strings currently, will need adaptation\r\n        }));\r\n\r\n        return NextResponse.json({ trips: formattedTrips });\r\n    } catch (error: any) {\r\n        console.error('[API_ERROR] Fetch trips failed:', {\r\n            message: error.message,\r\n            code: error.code,\r\n            meta: error.meta,\r\n            stack: error.stack\r\n        });\r\n        return NextResponse.json(\r\n            { message: 'Error al obtener viajes', detail: error.message },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { userId, destination, startDate, endDate } = await req.json();\r\n\r\n        if (!userId || !destination || !startDate || !endDate) {\r\n            return NextResponse.json({ message: 'Faltan datos' }, { status: 400 });\r\n        }\r\n\r\n        const trip = await prisma.trip.create({\r\n            data: {\r\n                userId,\r\n                destination,\r\n                startDate,\r\n                endDate,\r\n            },\r\n            include: { notes: true }\r\n        });\r\n\r\n        return NextResponse.json({\r\n            trip: {\r\n                id: trip.id,\r\n                destination: trip.destination,\r\n                startDate: trip.startDate,\r\n                endDate: trip.endDate,\r\n                notes: []\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error('Create trip error:', error);\r\n        return NextResponse.json({ message: 'Error al crear viaje' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAY;IAClC,IAAI;QACA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;QACxC,MAAM,SAAS,aAAa,GAAG,CAAC;QAEhC,QAAQ,GAAG,CAAC,uCAAuC;YAAE;QAAO;QAE5D,IAAI,CAAC,QAAQ;YACT,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;YAA0B,GACrC;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,QAAQ,MAAM,gIAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;YACrC,OAAO;gBAAE;YAAO;YAChB,SAAS;gBACL,OAAO;oBACH,SAAS;wBAAE,WAAW;oBAAO;gBACjC;YACJ;YACA,SAAS;gBAAE,WAAW;YAAO;QACjC;QAEA,sBAAsB;QACtB,MAAM,iBAAiB,MAAM,GAAG,CAAC,CAAC,OAAc,CAAC;gBAC7C,IAAI,KAAK,EAAE;gBACX,aAAa,KAAK,WAAW;gBAC7B,WAAW,KAAK,SAAS;gBACzB,SAAS,KAAK,OAAO;gBACrB,OAAO,KAAK,KAAK,CAAC,GAAG,CAAC,CAAC,IAAW,CAAC;wBAAE,IAAI,EAAE,EAAE;wBAAE,SAAS,EAAE,OAAO;oBAAC,CAAC;YACvE,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe;IACrD,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,mCAAmC;YAC7C,SAAS,MAAM,OAAO;YACtB,MAAM,MAAM,IAAI;YAChB,MAAM,MAAM,IAAI;YAChB,OAAO,MAAM,KAAK;QACtB;QACA,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAA2B,QAAQ,MAAM,OAAO;QAAC,GAC5D;YAAE,QAAQ;QAAI;IAEtB;AACJ;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElE,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,aAAa,CAAC,SAAS;YACnD,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YAClC,MAAM;gBACF;gBACA;gBACA;gBACA;YACJ;YACA,SAAS;gBAAE,OAAO;YAAK;QAC3B;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,MAAM;gBACF,IAAI,KAAK,EAAE;gBACX,aAAa,KAAK,WAAW;gBAC7B,WAAW,KAAK,SAAS;gBACzB,SAAS,KAAK,OAAO;gBACrB,OAAO,EAAE;YACb;QACJ;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ"}}]
}